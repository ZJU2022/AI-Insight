# 项目总览：HR制度问答系统

## 📋 项目结构

```
hr_policy_rag/
├── data/                          # 数据目录
│   └── hr_policy.txt              # HR制度文档（示例数据）
│
├── storage/                       # 存储目录（自动生成）
│   └── vectorstore/               # FAISS向量数据库文件
│
├── notebooks/                     # Jupyter Notebook教程
│   └── rag_tutorial.ipynb        # 分步教程
│
├── config.py                      # 配置管理
├── document_loader.py             # 文档加载和分块模块
├── vector_store.py                # 向量化和存储模块
├── rag_chain.py                   # RAG链实现
├── main.py                        # 主程序入口
├── __init__.py                    # Python包初始化
│
├── requirements.txt               # 项目依赖
├── README.md                      # 详细文档
├── QUICKSTART.md                  # 快速开始指南
└── PROJECT_OVERVIEW.md            # 本文件
```

## 🎯 核心模块说明

### 1. `config.py` - 配置管理
**作用**：集中管理所有配置项
- API密钥管理
- 模型参数配置
- 分块参数设置
- 检索参数配置

**学习要点**：
- 环境变量管理
- 配置类设计模式

### 2. `document_loader.py` - 文档加载
**作用**：加载和预处理文档
- 支持多种格式（TXT、PDF）
- 智能文档分块
- 元数据管理

**核心知识点**：
- **为什么需要分块**：LLM有上下文长度限制，长文档直接处理会丢失细节
- **分块策略**：
  - 固定窗口分块：按字符数切割
  - 滑动窗口分块：设置重叠区保持上下文
  - 按段落分块：适合结构化文档
- **分块参数**：
  - `chunk_size`: 每个块的大小（字符数）
  - `chunk_overlap`: 块之间的重叠（保持上下文连续性）

### 3. `vector_store.py` - 向量存储
**作用**：文档向量化和向量数据库管理
- Embedding向量化
- FAISS向量数据库
- 相似度搜索

**核心知识点**：
- **Embedding向量化**：
  - 将文本转换为高维向量（如1536维）
  - 语义相似的文本在向量空间中距离更近
  - 使用OpenAI的`text-embedding-3-small`模型
- **相似度计算**：
  - 余弦相似度：最常用，忽略向量长度差异
  - 欧氏距离：关注绝对距离
  - 内积：计算速度快
- **FAISS向量数据库**：
  - Facebook开源的向量数据库
  - 支持高效相似度搜索
  - 适合中小规模知识库（<1M条）

### 4. `rag_chain.py` - RAG链
**作用**：实现完整的RAG流程
- 检索相关文档
- Prompt构建
- LLM调用
- 结果格式化

**核心知识点**：
- **RAG流程**：
  1. 用户提问
  2. 问题向量化
  3. 知识库检索（Top-K）
  4. Prompt上下文增强
  5. LLM生成回答
  6. 返回带来源的回答
- **Prompt工程**：
  - 明确角色定位
  - 强调基于文档回答（减少幻觉）
  - 要求标注来源
  - 控制回答格式

### 5. `main.py` - 主程序
**作用**：程序入口和交互界面
- 知识库构建/加载
- 交互式问答
- 错误处理

## 🔄 RAG工作流程

```
┌─────────────┐
│  用户提问   │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ 问题向量化  │  ← 使用Embedding模型
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ 向量数据库  │  ← FAISS相似度搜索
│ 检索Top-K   │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ 格式化文档  │  ← 将检索结果格式化为上下文
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ Prompt构建  │  ← 注入上下文到Prompt
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  LLM生成    │  ← 调用GPT-3.5-turbo
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  返回回答   │  ← 带来源标注的回答
└─────────────┘
```

## 📚 学习路径

### 阶段1：理解基础概念
1. 阅读 `README.md` 了解RAG原理
2. 运行 `python main.py` 体验完整流程
3. 理解RAG的核心价值：为什么需要RAG？

### 阶段2：深入代码实现
1. 阅读 `document_loader.py` 理解文档处理
2. 阅读 `vector_store.py` 理解向量化
3. 阅读 `rag_chain.py` 理解RAG链
4. 运行各模块的演示脚本

### 阶段3：实践和优化
1. 使用 `notebooks/rag_tutorial.ipynb` 进行实验
2. 调整参数观察效果
3. 优化Prompt模板
4. 尝试添加新功能

### 阶段4：应用到其他场景
1. 替换数据源（法律文档、技术文档等）
2. 优化检索策略
3. 实现高级RAG技术

## 🎓 核心知识点总结

### RAG的核心价值
1. **解决知识更新滞后**：外挂动态更新的知识库
2. **解决领域适应性差**：注入领域专用数据源
3. **解决生成不可控**：基于检索结果约束生成
4. **解决数据隐私风险**：本地化知识库隔离敏感数据

### 关键技术点
1. **文档分块**：将长文档切分为适合向量化的文本块
2. **向量化**：将文本转换为高维向量，使语义相似的文本距离更近
3. **向量检索**：使用相似度搜索找到最相关的文档
4. **上下文增强**：将检索结果注入到Prompt中
5. **生成约束**：通过Prompt设计减少幻觉

### 最佳实践
1. **分块策略**：根据文档类型选择合适的分块方式
2. **检索数量**：Top-K的选择（通常3-5个）
3. **Prompt设计**：明确角色、强调基于文档、要求标注来源
4. **错误处理**：处理检索失败、生成失败等情况

## 🚀 进阶方向

### 1. 优化检索
- **混合检索**：结合关键词检索（BM25）和向量检索
- **重排序**：使用更强大的模型对检索结果重新排序
- **查询扩展**：将用户问题扩展为多个相关查询

### 2. 优化生成
- **多轮对话**：支持上下文记忆
- **置信度评估**：对低置信度回答进行标注
- **幻觉检测**：检测生成内容是否与检索文档一致

### 3. 高级RAG技术
- **Self-RAG**：自省式RAG，边回答边优化
- **GraphRAG**：基于知识图谱的RAG
- **T-RAG**：时序增强RAG，支持动态更新
- **CRAG**：置信度驱动的RAG

## 📊 项目特点

### ✅ 完整性
- 端到端的实现
- 从文档到问答的完整流程
- 包含数据、代码、文档

### ✅ 教育性
- 详细的代码注释
- 分模块的演示脚本
- 完整的README文档
- Jupyter Notebook教程

### ✅ 实用性
- 可直接运行
- 易于修改和扩展
- 清晰的代码结构
- 良好的错误处理

## 🎯 学习目标达成检查

完成这个项目后，你应该能够：

- [ ] 理解RAG的核心原理和工作流程
- [ ] 掌握文档加载和分块技术
- [ ] 理解Embedding向量化的原理
- [ ] 掌握向量数据库的使用（FAISS）
- [ ] 理解相似度搜索的原理
- [ ] 掌握Prompt工程的基本技巧
- [ ] 能够实现一个完整的RAG系统
- [ ] 能够优化和调试RAG系统

## 📝 下一步

1. **运行项目**：按照 `QUICKSTART.md` 快速开始
2. **阅读文档**：深入理解 `README.md`
3. **实验探索**：使用 `notebooks/rag_tutorial.ipynb`
4. **扩展应用**：应用到其他场景

祝你学习愉快！🎉

